{"ast":null,"code":"import _regeneratorRuntime from\"/Users/akshith/Documents/GitHub/Stocks-App/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/akshith/Documents/GitHub/Stocks-App/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/akshith/Documents/GitHub/Stocks-App/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import StockCard from'../components/Stock_card';import Navbar from'../components/Navbar';import'./Watchlist.css';import{Link}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var WatchlistPage=function WatchlistPage(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),stocks=_useState2[0],setStocks=_useState2[1];var _useState3=useState(1),_useState4=_slicedToArray(_useState3,2),currentPage=_useState4[0],setCurrentPage=_useState4[1];var stocksPerPage=30;var hasAccount=localStorage.getItem('hasAccount')==='true';useEffect(function(){var fetchUserStocks=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var email,response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;// Fetch user's stocks from the API based on their email\nemail=localStorage.getItem('email');if(!(email===null)){_context.next=4;break;}return _context.abrupt(\"return\");case 4:_context.next=6;return fetch(\"http://127.0.0.1:5000/users/\".concat(email,\"/watchlist\"));case 6:response=_context.sent;_context.next=9;return response.json();case 9:data=_context.sent;setStocks(data);_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);console.log('Error fetching user stocks:',_context.t0);case 16:case\"end\":return _context.stop();}},_callee,null,[[0,13]]);}));return function fetchUserStocks(){return _ref.apply(this,arguments);};}();// Fetch user's stocks when the component mounts\nfetchUserStocks();},[]);// Calculate the total number of pages based on the available stocks\nvar totalPages=Math.ceil(stocks.length/stocksPerPage);// Handle pagination\nvar goToPage=function goToPage(page){setCurrentPage(page);};// Calculate the index range for the current page\nvar indexOfLastStock=currentPage*stocksPerPage;var indexOfFirstStock=indexOfLastStock-stocksPerPage;var currentStocks=stocks.slice(indexOfFirstStock,indexOfLastStock);var deleteFromWatchlist=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(symbol){var email,response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;console.log('Deleting stock from portfolio:',symbol);// Make the API request to delete the stock from the portfolio\nemail=localStorage.getItem('email');_context2.next=5;return fetch(\"http://127.0.0.1:5000/users/\".concat(email,\"/watchlist/\").concat(symbol),{method:'DELETE'});case 5:response=_context2.sent;if(response.ok){// Remove the deleted stock from the local state\nsetStocks(function(prevStocks){return prevStocks.filter(function(stock){return stock.symbol!==symbol;});});console.log('Stock deleted successfully');}else{console.log('Failed to delete stock from watchlist');}_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);console.log('Error deleting stock from watchlist:',_context2.t0);// Add your logic here for handling the error in deleting the stock from the portfolio\ncase 12:case\"end\":return _context2.stop();}},_callee2,null,[[0,9]]);}));return function deleteFromWatchlist(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-800 min-h-screen\",children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto py-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-white mb-4\",children:\"Watchlist\"}),!hasAccount&&/*#__PURE__*/_jsx(\"div\",{className:\"container mx-auto mt-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white shadow-lg rounded-lg p-8 text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-lg font-semibold mb-4\",children:\"You don't have an account.\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(Link,{to:\"/signup\",className:\"text-indigo-600 hover:text-indigo-500\",children:\"Sign up\"}),' ',\"or\",' ',/*#__PURE__*/_jsx(Link,{to:\"/login\",className:\"text-indigo-600 hover:text-indigo-500\",children:\"login\"}),' ',\"to create an account.\"]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"stock-cards grid grid-cols-2 gap-4\",children:currentStocks.length>0?currentStocks.map(function(stock){return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-creamwhite rounded-lg p-4 flex flex-col justify-between\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-grow\",children:/*#__PURE__*/_jsx(StockCard,{stock:stock})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center mt-4\",children:/*#__PURE__*/_jsx(\"button\",{className:\"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg\",onClick:function onClick(){return deleteFromWatchlist(stock.symbol);},children:\"Delete\"})})]},stock.symbol);}):/*#__PURE__*/_jsx(\"p\",{className:\"text-white\",children:\"No stocks in watchlist\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"pagination mt-4\",children:Array.from({length:totalPages},function(_,index){return index+1;}).map(function(page){return/*#__PURE__*/_jsx(\"button\",{className:\"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg mr-2\",onClick:function onClick(){return goToPage(page);},children:page},page);})})]})]});};export default WatchlistPage;","map":{"version":3,"names":["React","useState","useEffect","StockCard","Navbar","Link","jsx","_jsx","jsxs","_jsxs","WatchlistPage","_useState","_useState2","_slicedToArray","stocks","setStocks","_useState3","_useState4","currentPage","setCurrentPage","stocksPerPage","hasAccount","localStorage","getItem","fetchUserStocks","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","email","response","data","wrap","_callee$","_context","prev","next","abrupt","fetch","concat","sent","json","t0","console","log","stop","apply","arguments","totalPages","Math","ceil","length","goToPage","page","indexOfLastStock","indexOfFirstStock","currentStocks","slice","deleteFromWatchlist","_ref2","_callee2","symbol","_callee2$","_context2","method","ok","prevStocks","filter","stock","_x","className","children","to","map","onClick","Array","from","_","index"],"sources":["/Users/akshith/Documents/GitHub/Stocks-App/src/pages/Watchlist.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport StockCard from '../components/Stock_card';\nimport Navbar from '../components/Navbar';\nimport './Watchlist.css';\nimport { Link } from 'react-router-dom';\n\nconst WatchlistPage = () => {\n  const [stocks, setStocks] = useState([]);\n  const [currentPage, setCurrentPage] = useState(1);\n  const stocksPerPage = 30;\n    const hasAccount = localStorage.getItem('hasAccount') === 'true';\n  useEffect(() => {\n    const fetchUserStocks = async () => {\n      try {\n        // Fetch user's stocks from the API based on their email\n        const email = localStorage.getItem('email');\n        if (email === null) {\n          return;\n        }\n        const response = await fetch(`http://127.0.0.1:5000/users/${email}/watchlist`);\n        const data = await response.json();\n        setStocks(data);\n      } catch (error) {\n        console.log('Error fetching user stocks:', error);\n      }\n    };\n\n    // Fetch user's stocks when the component mounts\n    fetchUserStocks();\n  }, []);\n\n  // Calculate the total number of pages based on the available stocks\n  const totalPages = Math.ceil(stocks.length / stocksPerPage);\n\n  // Handle pagination\n  const goToPage = (page) => {\n    setCurrentPage(page);\n  };\n\n  // Calculate the index range for the current page\n  const indexOfLastStock = currentPage * stocksPerPage;\n  const indexOfFirstStock = indexOfLastStock - stocksPerPage;\n  const currentStocks = stocks.slice(indexOfFirstStock, indexOfLastStock);\n\n  const deleteFromWatchlist = async (symbol) => {\n    try {\n      console.log('Deleting stock from portfolio:', symbol);\n      // Make the API request to delete the stock from the portfolio\n      const email = localStorage.getItem('email');\n      const response = await fetch(`http://127.0.0.1:5000/users/${email}/watchlist/${symbol}`, {\n        method: 'DELETE',\n      });\n      if (response.ok) {\n        // Remove the deleted stock from the local state\n        setStocks((prevStocks) => prevStocks.filter((stock) => stock.symbol !== symbol));\n        console.log('Stock deleted successfully');\n      } else {\n        console.log('Failed to delete stock from watchlist');\n      }\n    } catch (error) {\n      console.log('Error deleting stock from watchlist:', error);\n      // Add your logic here for handling the error in deleting the stock from the portfolio\n    }\n  };\n\n  return (\n    <div className=\"bg-gray-800 min-h-screen\">\n  <Navbar />\n  <div className=\"container mx-auto py-8\">\n    <h1 className=\"text-3xl font-bold text-white mb-4\">Watchlist</h1>\n    {!hasAccount && (\n          <div className=\"container mx-auto mt-8\">\n            <div className=\"bg-white shadow-lg rounded-lg p-8 text-center\">\n              <p className=\"text-lg font-semibold mb-4\">You don't have an account.</p>\n              <p>\n                <Link to=\"/signup\" className=\"text-indigo-600 hover:text-indigo-500\">\n                  Sign up\n                </Link>{' '}\n                or{' '}\n                <Link to=\"/login\" className=\"text-indigo-600 hover:text-indigo-500\">\n                  login\n                </Link>{' '}\n                to create an account.\n              </p>\n            </div>\n          </div>\n        )}\n    <div className=\"stock-cards grid grid-cols-2 gap-4\">\n      {currentStocks.length > 0 ? (\n        currentStocks.map((stock) => (\n          <div key={stock.symbol} className=\"bg-creamwhite rounded-lg p-4 flex flex-col justify-between\">\n            <div className=\"flex-grow\">\n              <StockCard stock={stock} />\n            </div>\n            <div className=\"flex justify-center mt-4\">\n              <button\n                className=\"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg\"\n                onClick={() => deleteFromWatchlist(stock.symbol)}\n              >\n                Delete\n              </button>\n            </div>\n          </div>\n        ))\n      ) : (\n        <p className=\"text-white\">No stocks in watchlist</p>\n      )}\n    </div>\n    <div className=\"pagination mt-4\">\n      {Array.from({ length: totalPages }, (_, index) => index + 1).map((page) => (\n        <button\n          key={page}\n          className=\"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg mr-2\"\n          onClick={() => goToPage(page)}\n        >\n          {page}\n        </button>\n      ))}\n    </div>\n  </div>\n</div>\n\n  );\n};\n\nexport default WatchlistPage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}